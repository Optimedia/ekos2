/* *  SISTEMA: SALA DE ATENDIMENTO *  ABRIL DE 2011 * */ //contUsers = 0;load("netservices.asc");startGateway = false;	application.onAppStart = function() {	application.allowDebug = true;		trace("\n:: Iniciando aplicação...");	application.usersSo = SharedObject.get("filaAtendimento", false);	application.nextId = 0;};setIniciaGateway = function (gateway) {	NetServices.setDefaultGatewayUrl(gateway);	this.cgwc = NetServices.createGatewayConnection();};application.onConnect = function(con, userName) {	trace("\n:: Usuario conectando... ID: " + userName);	if (startGateway == false) {		setIniciaGateway("http://10.1.1.10/amf/gateway.php");		startGateway = true;	}	con.id = "u" + application.nextId++;	con.name = userName;	con.serv = cgwc.getService("atendimento.Manager", new NS_Result(con));	application.acceptConnection(con);	//application.usersSo.setProperty(con.name, userName);};application.onDisconnect = function(client) {		trace("\n:: Usuario desconectado: nome: " + client.name);	application.usersSo.setProperty(client.name, null);	client.close;};// SERVICOS REMOTOSfunction NS_Result(con) {	this.con = con;		this.onResult = function(result) {		trace("\n:: Dados recebidos no servidor : "+result);	};	this.onStatus = function(error) {		trace("\n:: Erro : "+error.description);	};	}// SERVICOSClient.prototype.iniciaFila = function(obj) {		trace("\n:: iniciaFila-> Usuario entrando na fila...");	this.serv.iniciaFila(obj);};NS_Result.prototype.iniciaFila_Result = function(objeto) {		trace("\n:: iniciaFila_Result-> Usuario foi..."+ objeto['email'] +"-"+objeto['cliente']);		application.usersSo.setProperty(objeto['email'], objeto['cliente']);	this.con.call("iniciaAtendimento_Result", null, objeto);		};Client.prototype.loginAtendente = function(obj) {		this.serv.loginAtendente(obj);	trace("\n:: Atendente logando... obj:" + obj);};NS_Result.prototype.loginAtendente_Result = function(objeto) {			this.con.call("loginAtendente_Result", null, objeto);	trace("\n:: Atendente logado. obj: "+objeto);};